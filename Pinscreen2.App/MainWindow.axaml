<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vlc="clr-namespace:LibVLCSharp.Avalonia;assembly=LibVLCSharp.Avalonia"
        mc:Ignorable="d" d:DesignWidth="1280" d:DesignHeight="720"
        x:Class="Pinscreen2.App.MainWindow"
        Title="Pinscreen 2"
        CanResize="True"
        Background="#000000">
    <Grid Name="RootGrid" PointerPressed="OnRootPointerPressed">
        <vlc:VideoView Name="VideoView" />

        <!-- Clock as Popup so it renders above native VideoView but below overlay -->
        <Popup Name="ClockPopup"
               PlacementTarget="{Binding ElementName=RootGrid}"
               Placement="AnchorAndGravity"
               PlacementAnchor="TopLeft"
               PlacementGravity="BottomRight"
               IsOpen="True">
            <Canvas Background="#00000000" PointerPressed="OnRootPointerPressed"
                    Width="{Binding $parent[Popup].PlacementTarget.Bounds.Width}"
                    Height="{Binding $parent[Popup].PlacementTarget.Bounds.Height}">
                <TextBlock Name="ClockText"
                           Foreground="White"
                           FontSize="72"
                           FontWeight="Bold"
                           TextAlignment="Center"
                           Cursor="SizeAll"
                           PointerPressed="OnClockPointerPressed"
                           PointerMoved="OnClockPointerMoved"
                           PointerReleased="OnClockPointerReleased"
                           Text="--:--:--" />
            </Canvas>
        </Popup>

        <!-- Overlay shown via Popup to ensure it renders above native VideoView and clock, within app -->
        <Popup Name="OverlayPopup"
               PlacementTarget="{Binding ElementName=RootGrid}"
               Placement="AnchorAndGravity"
               PlacementAnchor="TopLeft"
               PlacementGravity="BottomRight"
               IsOpen="False">
            <Grid Width="{Binding $parent[Popup].PlacementTarget.Bounds.Width}"
                  Height="{Binding $parent[Popup].PlacementTarget.Bounds.Height}">
                <Border Background="#80000000"
                        PointerPressed="OnOverlayBackdropPressed">
                    <Border Name="OverlayPanel"
                            Background="#222222"
                            CornerRadius="8"
                            Padding="16"
                            MaxWidth="840"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            PointerPressed="OnOverlayPanelPressed">
                        <StackPanel Spacing="12">
                            <TextBlock Text="Pinscreen Options" FontSize="24" Foreground="White"/>
                            <Separator/>
                            <WrapPanel>
                                <Button Name="BtnPlayPause" Margin="0,0,8,8" Click="OnPlayPauseClicked">Play/Pause</Button>
                                <Button Margin="0,0,8,8" Click="OnNextClicked">Next</Button>
                                <Button Margin="0,0,8,8" Click="OnRebuildQueueClicked">Rebuild Queue</Button>
                                <Button Margin="0,0,8,8" Click="OnSetMediaFolderClicked">Set Media Folderâ€¦</Button>
                                <Button Margin="0,0,8,8" Click="OnOpenConfigClicked">Open Config</Button>
                                <Button Margin="0,0,8,8" Click="OnOpenCurrentFolderClicked">Open Current Folder</Button>
                                <Button Margin="0,0,8,8" Click="OnQuitClicked">Quit</Button>
                            </WrapPanel>
                            <StackPanel Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
                                <TextBlock Text="Clock Font:" Foreground="#CCCCCC" VerticalAlignment="Center"/>
                                <ComboBox Name="ClockFontCombo" Width="260" SelectionChanged="OnClockFontSelectionChanged"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
                                <TextBlock Text="Clock Color:" Foreground="#CCCCCC" VerticalAlignment="Center"/>
                                <ComboBox Name="ClockColorCombo" Width="180" SelectionChanged="OnClockColorSelectionChanged">
                                    <ComboBoxItem Content="White" Tag="#FFFFFFFF"/>
                                    <ComboBoxItem Content="Black" Tag="#FF000000"/>
                                    <ComboBoxItem Content="Red" Tag="#FFFF3B30"/>
                                    <ComboBoxItem Content="Orange" Tag="#FFFF9500"/>
                                    <ComboBoxItem Content="Yellow" Tag="#FFFFCC00"/>
                                    <ComboBoxItem Content="Green" Tag="#FF34C759"/>
                                    <ComboBoxItem Content="Cyan" Tag="#FF32ADE6"/>
                                    <ComboBoxItem Content="Blue" Tag="#FF007AFF"/>
                                    <ComboBoxItem Content="Purple" Tag="#FFAF52DE"/>
                                    <ComboBoxItem Content="Magenta" Tag="#FFFF2D55"/>
                                </ComboBox>
                            </StackPanel>
                            <TextBlock Name="StatusText" Foreground="#CCCCCC"/>
                            <TextBlock Text="Tip: click anywhere to toggle this overlay. Press Esc to close." Foreground="#CCCCCC"/>
                        </StackPanel>
                    </Border>
                </Border>
            </Grid>
        </Popup>
    </Grid>
</Window>
